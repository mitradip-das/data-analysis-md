<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>Documentation: The Analysis Codes</title>
  </head>
  <body style=" line-height:1.5;">
    <div style="text-align: justify;"><span><span></span></span><br>
    </div>
    <div style="text-align: justify;">
      <div>
        <table style="width: 100%; text-align: left; margin-left: 0px; margin-right: 0px;"
          border="0">
          <tbody>
            <tr>
              <td style="width: 800px;">
                <h1><span><span>The Analysis Codes</span></span><span><span></span></span></h1>
                <div>Author: MITRADIP DAS, NISER, Bhubaneswar</div>
                <div>
                  <h2>Compiler Information:</h2>
                  <div style="text-align: justify;">The codes were compiled and
                    tested using <strong>clang++-5.0</strong> using <strong>c++14
                      standard</strong> in <strong>Linux 4.8</strong> (Linux
                    Mint 18.2). Compilation should be done for <em>rdf_1.cpp</em>
                    or <em>msd_1.cpp</em> only as per the requirements.</div>
                </div>
                <div>
                  <h2>File: cpp_include/libraries.h</h2>
                  <div style="text-align: justify;">This file contains different
                    libraries and generic functions used in the code. It
                    references to different standard c++ libraries like <em>iostream</em>,
                    <em>fstream</em> etc. The generic functions contained are:</div>
                  <div style="text-align: justify;">
                    <ul>
                      <li><strong>std::string trim_left(const std::string&amp;
                          str): </strong>This function left trims a string <em>str</em>.</li>
                      <li><strong>std::string trim_right(const std::string&amp;
                          str)</strong>: This function right trims a string <em>str.</em></li>
                      <li><strong>std::string trim(const std::string&amp; str):</strong>
                        This function trims a string <em>str</em> using <em>trim_left
                          </em>and <em>trim_right.</em></li>
                      <li><strong>long int line_skip(string file_name,long int
                          start_pos,long int lines): </strong>This functions
                        returns the position of the get pointer in file <em>file_name</em>
                        after skipping <em>lines</em> lines starting from
                        position of get pointer <em>start_pos</em>.</li>
                    </ul>
                    <ul>
                    </ul>
                    <div>
                      <h2>File: analysis.cpp</h2>
                      <div>This file contains the codes for analysis of the
                        system. It has different classes for different sections
                        of the work. This file implements <em>cpp_include/libraries.h</em><em></em>.</div>
                      <div style="text-align: justify;">
                        <ul>
                          <li><strong>class atom: </strong>Each object of this
                            class represents an atom and it contains properties
                            of atom like ID, name, Residue (molecule) ID and
                            coordinates.</li>
                          <ul>
                            <li><strong>void show(): </strong>This is used to
                              display the atom and the above properties.</li>
                          </ul>
                        </ul>
                        <div>
                          <ul>
                            <li><strong>class frame:</strong> This frame
                              represents one frame from a run of MD simulation.
                              It contains information of multiple atoms
                              (implemented as a vector) and the corresponding
                              box length of the&nbsp;frame.</li>
                            <ul>
                              <li><strong>long int read_file(string
                                  file_name,long int start_line): </strong>This
                                function reads the atoms from a PDB file <em>file_name</em>
                                generated using VMD (implementing PBC) with get
                                pointer from <em>start_line</em> till "END" is
                                encountered. It returns the current position of
                                the get pointer in the file (useful while
                                implementing multiple frames).</li>
                              <li><strong>void clear_all()</strong>: Clear all
                                the information present in a frame.</li>
                              <li><strong>void set_box(double len):</strong>
                                Sets the box length to <em>len.</em></li>
                              <li><strong>void show_frame(): </strong>Display
                                all the data of the whole frame.</li>
                              <li><strong>double calc_dist_pbc(long int id1,long
                                  int id2):</strong> This function returns the
                                distance between two atoms with <em>id1</em>
                                and <em>id2</em> implementing PBC.</li>
                              <li><strong>void get_idx_of(string
                                  src,std::vector&lt;int&gt; &amp;v):</strong>
                                This functions stores all the index of atoms
                                with name <em>src</em> in referenced vector <em>v</em>.</li>
                              <li><strong>void pair_rdf_fn(double start, double
                                  stop, double interval, const string pairs[],
                                  std::vector &lt;array &lt;double,2&gt;&gt;
                                  &amp;rdf): </strong>This function calculates
                                the RDF of the current frame between atom types
                                given in <em>pairs[]</em>. The variables <em>start,
                                  stop </em>and <em>interval</em> defines the
                                start, end and mesh size of the RDF, in
                                referenced vector <em>rdf.</em> The RDF
                                implements PBC conditions and hence non-zero
                                results exists only up to half of box length.</li>
                            </ul>
                          </ul>
                          <div>
                            <ul>
                              <li><strong>class trajectory: </strong>This class
                                represents the trajectory of the atoms and
                                implements a vector of frames in order to
                                achieve this target.</li>
                              <ul>
                                <li><strong>long int read_frames(string
                                    file_name, long int st_pos, long int
                                    nframes, double boxl):</strong> This
                                  function is used to read <em>nframes</em>
                                  frames from a PDB file <em>file_name</em>
                                  generated by VMD starting from file get
                                  pointer <em>st_pos</em>. This function also
                                  fixes the box length of each frame to <em>boxl</em>
                                  and it return the current position of get
                                  pointer after reading the frames.</li>
                                <li><strong>void pair_rdf_fn(double start,
                                    double stop, double interval, const string
                                    pairs[], std::vector
                                    &lt;array&lt;double,2&gt;&gt; &amp;rdf):</strong>
                                  This function gives the time average of RDF
                                  implementing <em>pair_rdf_fn</em> from class
                                  frame.</li>
                                <li><strong>double idx_msd_fn(int dt,const int
                                    idx):</strong> This function calculates and
                                  returns the MSD of atom present in index <em>idx</em>
                                  for a frame (or time) interval <em>dt</em>.</li>
                                <li><strong>double type_msd_fn(int dt,const
                                    string src):</strong> This function
                                  calculates and returns the MSD of an atom type
                                  <em>src</em> over the whole ensemble for a
                                  frame (or time) interval <em>dt</em>. This
                                  implements the <em>idx_msd_fn</em>.</li>
                                <li><strong>void type_msd_fn_all_dt(const string
                                    src,std::vector&lt;array&lt;double,2&gt;&gt;
                                    &amp;v):</strong> This function calculates
                                  the overall MSD for all possible frame
                                  intervals, 1 to (no of frames-1), for a given
                                  atom type <em>src</em> and stores it in the
                                  reference vector <em>v</em>.</li>
                              </ul>
                            </ul>
                            <div>
                              <h2>File: rdf_1.cpp</h2>
                              <div>This file contains the <em>main()</em>
                                function demonstrating a sample RDF run.</div>
                              <div>
                                <h2>File: msd_1.cpp</h2>
                                <div>This file contains the <em>main() </em>function
                                  demonstrating a sample MSD run.</div>
                              </div>
                            </div>
                            <ul>
                              <ul>
                              </ul>
                            </ul>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </td>
              <td><br>
              </td>
            </tr>
          </tbody>
        </table>
        <br>
      </div>
    </div>
    <span><span> </span></span>
  </body>
</html>
